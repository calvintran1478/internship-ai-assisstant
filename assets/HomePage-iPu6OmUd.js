import{u as N,c as v,e as E,t as u,i as c,a as d,f as A,S as w,F as L,b as D,s as I,g as T,d as b}from"./index-DBx0BX1s.js";import{A as F}from"./components-D6KTurwx.js";var H=u('<div class="flex justify-center items-center fixed top-6 right-6 rounded-full w-12 h-12 border"><p>'),R=u('<div class="flex flex-col justify-center items-center h-screen w-screen"><form class="flex flex-col"><label class="text-3xl mb-8">Hello! How can I help with your career?</label><input class="border rounded w-lg h-10"placeholder="Ask me anything...">'),j=u('<div class="flex flex-col items-center"><form class="flex flex-col fixed bottom-20"><input class="border rounded w-lg h-10"placeholder="Ask me anything...">'),q=u("<div>"),z=u("<p>");const U=()=>{const m=N(),[_,y]=v(""),[C,S]=v(""),[o,$]=v([]);let f="";const k=async()=>{const r=localStorage.getItem("accessToken");r===null&&m("/login");const e=await fetch(`${b}/api/v1/users/name`,{headers:{Authorization:`Bearer ${r}`}});if(e.ok){const t=(await e.text()).split(`
`);y(t[0]),S(t[1])}else e.status===401&&m("/login")};E(()=>{k()});const x=async r=>{r.preventDefault(),document.querySelector("form").reset(),$(o().concat([f,""]));const e=localStorage.getItem("accessToken");e===null&&m("/login");const i=(await fetch(`${b}/api/v1/chat`,{method:"POST",headers:{Authorization:`Bearer ${e}`},body:f})).body.getReader(),s=new TextDecoder("utf-8"),n=o().length-1;let l=!1;for(;!l;){const{value:a,done:g}=await i.read();if(l=g,a){const h=s.decode(a,{stream:!0}),p=[...o()];p[n]=p[n]+h,$(p)}}};return(()=>{var r=q();return c(r,d(w,{get when(){return o().length===0},get children(){return[d(A,{get children(){return d(F,{href:"/profile",get children(){var e=H(),t=e.firstChild;return c(t,()=>_().toUpperCase()[0],null),c(t,()=>C().toUpperCase()[0],null),e}})}}),(()=>{var e=R(),t=e.firstChild,i=t.firstChild,s=i.nextSibling;return t.addEventListener("submit",x),s.addEventListener("change",n=>{f=n.target.value}),e})()]}}),null),c(r,d(w,{get when(){return o().length!==0},get children(){var e=j(),t=e.firstChild,i=t.firstChild;return c(e,d(L,{get each(){return o()},children:(s,n)=>(()=>{var l=z();return c(l,s),D(a=>{var g=`top: ${n()*80}px`,h=`fixed border rounded p-4 m-4 ${n()%2===0?"right-0":"left-0"}`;return a.e=I(l,g,a.e),h!==a.t&&T(l,a.t=h),a},{e:void 0,t:void 0}),l})()}),t),t.addEventListener("submit",x),i.addEventListener("change",s=>{f=s.target.value}),e}}),null),r})()};export{U as default};
